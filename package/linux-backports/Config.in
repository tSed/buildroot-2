config BR2_PACKAGE_LINUX_BACKPORTS
	bool "linux-backports"
	depends on BR2_LINUX_KERNEL
	help
	  Compatibility driver backports (former compat-wireless).

	  http://wireless.kernel.org/

if BR2_PACKAGE_LINUX_BACKPORTS

#
# Version selection. We provide the choice between:
#
#  1. A single fairly recent stable backpoorts version
#  2. A custom stable version
#  3. A custom tarball
#  4. A custom repository
#
choice
	prompt "Backports version"

config BR2_PACKAGE_LINUX_BACKPORTS_3_7_9
	bool "3.7.9"
	depends on BROKEN
	select BR2_PACKAGE_LINUX_BACKPORTS_DONT_USE_DOT_CONFIG

config BR2_PACKAGE_LINUX_BACKPORTS_3_8_3
	bool "3.8.3"
	depends on BROKEN
	select BR2_PACKAGE_LINUX_BACKPORTS_DONT_USE_DOT_CONFIG

config BR2_PACKAGE_LINUX_BACKPORTS_3_10_19
	bool "3.10.19"

config BR2_PACKAGE_LINUX_BACKPORTS_3_11_8
	bool "3.11.8"

config BR2_PACKAGE_LINUX_BACKPORTS_3_12_8
	bool "3.12.8"

config BR2_PACKAGE_LINUX_BACKPORTS_3_13_2
	bool "3.13.2"

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION
	bool "Custom version"

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_TARBALL
	bool "Custom tarball"
	help
	  This option allows to specify the http or ftp location of a
	  specific kernel source tarball

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_GIT
	bool "Custom Git repository"
	help
	  This option allows Buildroot to get the backport source code
	  from a Git repository.

	  The official git tree on kernel.org:
	    git://git.kernel.org/pub/scm/linux/kernel/git/backports/backports.git
	  cannot be used here since the makefiles prevent from in-git-tree
	  build; however any git repository initialized from a release
	  tarball is fine.

endchoice

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION_VALUE
	string "Backports version"
	depends on BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_TARBALL_LOCATION
	string "URL of custom backports tarball"
	depends on BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_TARBALL

if BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_GIT

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_REPO_URL
	string "URL of custom repository"

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_REPO_VERSION
	string "Custom repository version"

endif

config BR2_PACKAGE_LINUX_BACKPORTS_VERSION
	string
	default "3.7.9-1"   if BR2_PACKAGE_LINUX_BACKPORTS_3_7_9
	default "3.8.3-2"   if BR2_PACKAGE_LINUX_BACKPORTS_3_8_3
	default "3.10.19-1" if BR2_PACKAGE_LINUX_BACKPORTS_3_10_19
	default "3.11.8-1"  if BR2_PACKAGE_LINUX_BACKPORTS_3_11_8
	default "3.12.8-1"  if BR2_PACKAGE_LINUX_BACKPORTS_3_12_8
	default "3.13.2-1"  if BR2_PACKAGE_LINUX_BACKPORTS_3_13_2
	default BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION_VALUE \
		if BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION
	default "custom" if BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_TARBALL
	default BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_REPO_VERSION \
		if BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_GIT


#
# Patch selection
#

config BR2_PACKAGE_LINUX_BACKPORTS_PATCH
	string "Custom backports patches"
	help
	  A space-separated list of patches to apply to the
	  kernel. Each patch can be described as an URL, a local file
	  path, or a directory. In the case of a directory, all files
	  matching linux-*.patch in the directory will be applied.

#
# Configuration selection
#

#
# backports < 3.10 (named compat-drivers) do not support menuconfig
# command, the config is done (hardcoded) via a config.mk file
#

config BR2_PACKAGE_LINUX_BACKPORTS_DONT_USE_DOT_CONFIG
	bool "use config.mk for configuration"
	depends on BROKEN
	depends on BR2_PACKAGE_LINUX_BACKPORTS_3_7_9 || \
		BR2_PACKAGE_LINUX_BACKPORTS_3_8_3 || \
		BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_VERSION || \
		BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_TARBALL || \
		BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_GIT
	help
	  Prior to version 3.10, linux-backports (named compat-wireless,
	  then compat-drivers) use a config.mk file for the driver
	  selection, instead of a defconfig or .config file.

	  For backports prior to version 3.10, the configuration is usually
	  done by running the select_driver script (from the sources) or by
	  hacking the makefile.

	  Since there is no easy and generic way to configure these
	  linux-backports versions, it is sugested to provided your own
	  patch set to define the configuration meeting your requirements.

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_CONFIG_MK_FILE
	string "Configuration (config.mk) file path"
	depends on BR2_PACKAGE_LINUX_BACKPORTS_DONT_USE_DOT_CONFIG
	help
	  Path to the linux-backports config.mk configuration file.

	  Leave empty if the configuration is already set in the source tree
	  (via patches or custom sources).

if !BR2_PACKAGE_LINUX_BACKPORTS_DONT_USE_DOT_CONFIG

choice
	prompt "Backport configuration"
	default BR2_PACKAGE_LINUX_BACKPORTS_USE_DEFCONFIG

config BR2_PACKAGE_LINUX_BACKPORTS_USE_DEFCONFIG
	bool "Using a defconfig"

config BR2_PACKAGE_LINUX_BACKPORTS_USE_CUSTOM_CONFIG
	bool "Using a custom config file"

endchoice

config BR2_PACKAGE_LINUX_BACKPORTS_DEFCONFIG
	string "Defconfig name"
	depends on BR2_PACKAGE_LINUX_BACKPORTS_USE_DEFCONFIG
	help
	  Name of the backports defconfig file to use, without the
	  leading 'defconfig-'.  The defconfig is located in
	  defconfigs/ in the linux-backports tree.

config BR2_PACKAGE_LINUX_BACKPORTS_CUSTOM_CONFIG_FILE
	string "Configuration file path"
	depends on BR2_PACKAGE_LINUX_BACKPORTS_USE_CUSTOM_CONFIG
	help
	  Path to the linux-backports configuration file

endif
endif
